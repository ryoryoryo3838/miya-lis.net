// Generated by Melange


const $$Map = {};

const idMap = {};

function fresh(str) {
  const v = idMap[str];
  const id = (v == null) ? 1 : v + 1 | 0;
  idMap[str] = id;
  return id;
}

function create(str) {
  const id = fresh(str);
  return str + ("/" + id);
}

function caml_is_extension(e) {
  if (e == null) {
    return false;
  } else {
    return typeof e.MEL_EXN_ID === "string";
  }
}

function caml_exn_slot_name(x) {
  return x.MEL_EXN_ID;
}

const caml_exn_slot_id = (function(x){
  if (x.MEL_EXN_ID != null) {
    var parts = x.MEL_EXN_ID.split("/");
    if (parts.length > 1) {
      return Number(parts[parts.length - 1])
    } else {
      return -1;
    }
  } else {
    return -1;
  }
}
);

export {
  $$Map,
  idMap,
  fresh,
  create,
  caml_is_extension,
  caml_exn_slot_name,
  caml_exn_slot_id,
}
/* No side effect */
